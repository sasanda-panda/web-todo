(this["webpackJsonpweb-todo"]=this["webpackJsonpweb-todo"]||[]).push([[0],{100:function(t,e,n){"use strict";n.r(e);var c,o,i,a,s=n(4),r=n.n(s),d=n(65),u=n.n(d),l=n(26),j=n(50),b=n.n(j),O=n(66),h=n(27),f=n(67),x=n(72),p=n(69),m=n(101),v=n(7),_=function(){var t=Object(l.b)().loginWithPopup;return Object(v.jsx)("button",{className:"auth-button",onClick:function(){return t()},children:"Log in"})},g=function(){var t=Object(l.b)().logout;return Object(v.jsx)("button",{className:"auth-button",onClick:function(){return t()},children:"Log out"})},w=function(t){return new f.a({link:new p.a({uri:"wss://sp0483-web-todo.hasura.app/v1/graphql",options:{reconnect:!0,connectionParams:{headers:{Authorization:"Bearer ".concat(t)}}}}),cache:new x.a})},N=function(t){var e=t.children,n=Object(s.useState)(null),c=Object(h.a)(n,2),o=c[0],i=c[1],a=Object(l.b)(),r=a.isAuthenticated,d=a.getAccessTokenSilently,u=function(){var t=Object(O.a)(b.a.mark((function t(){var e,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d();case 2:e=t.sent,n=w(e),i(n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(s.useEffect)((function(){r&&u()}),[r]),r?o?Object(v.jsxs)(m.ApolloProvider,{client:o,children:[e,Object(v.jsx)(g,{})]}):Object(v.jsx)("div",{className:"apollo",children:Object(v.jsx)(g,{})}):Object(v.jsx)("div",{className:"apollo",children:Object(v.jsx)(_,{})})},y=n(32),k=n(33),C=n.n(k),S=C()(c||(c=Object(y.a)(["\n  mutation insertTodo($title: String!, $content: String) {\n    insert_todos(objects: {title: $title, content: $content}) {\n      affected_rows\n    }\n  }\n"]))),$=C()(o||(o=Object(y.a)(["\n  mutation updateTodoIsDone($id: Int!, $is_done: Boolean) {\n    update_todos(where: {id: {_eq: $id}}, _set: {is_done: $is_done}) {\n      affected_rows\n    }\n  }\n"]))),I=C()(i||(i=Object(y.a)(["\n  mutation deleteTodo($id: Int) {\n    delete_todos(where: {id: {_eq: $id}}) {\n      affected_rows\n    }\n  }\n"]))),T=C()(a||(a=Object(y.a)(["\n  subscription fetchNewTodos {\n    todos(order_by: {created_at: desc}) {\n      content\n      created_at\n      id\n      is_done\n      title\n      user_id\n    }\n  }\n"]))),E=n(46),F=function(){var t=Object(s.useState)(""),e=Object(h.a)(t,2),n=e[0],c=e[1],o=Object(s.useState)(""),i=Object(h.a)(o,2),a=i[0],r=i[1],d=Object(m.useSubscription)(T),u=d.loading,l=d.error,j=d.data,b=Object(m.useMutation)(S),O=Object(h.a)(b,1)[0],f=Object(m.useMutation)($),x=Object(h.a)(f,1)[0],p=Object(m.useMutation)(I),_=Object(h.a)(p,1)[0];return u?Object(v.jsx)("div",{className:"todo",children:Object(v.jsx)("div",{children:"Loading..."})}):l?Object(v.jsx)("div",{className:"todo",children:Object(v.jsx)("div",{children:"Error..."})}):Object(v.jsxs)("div",{className:"todo",children:[Object(v.jsxs)("form",{className:"todo-form",onSubmit:function(t){return function(t){t.preventDefault(),n&&(O({variables:{title:n,content:a}}),c(""),r(""))}(t)},children:[Object(v.jsx)("input",{type:"text",value:n,placeholder:"Enter the title",onChange:function(t){return c(t.target.value)}}),Object(v.jsx)("input",{type:"text",value:a,placeholder:"Enter the content",onChange:function(t){return r(t.target.value)}}),Object(v.jsx)("input",{type:"submit",value:""}),Object(v.jsx)("span",{children:Object(v.jsx)(E.a,{})})]}),Object(v.jsx)("ul",{className:"todo-list",children:null===j||void 0===j?void 0:j.todos.map((function(t){return Object(v.jsxs)("li",{className:"todo-item",children:[Object(v.jsx)("div",{className:"todo-item__head",children:Object(v.jsx)("div",{className:"todo-item__head__check ".concat(t.is_done&&"is-done"),onClick:function(){return function(t){x({variables:{id:t.id,is_done:!t.is_done}})}(t)},children:Object(v.jsx)(E.b,{})})}),Object(v.jsxs)("div",{className:"todo-item__body",children:[Object(v.jsx)("input",{type:"text",name:"title",className:"todo-item__body__title",defaultValue:t.title}),(null===t||void 0===t?void 0:t.content)&&Object(v.jsx)("input",{type:"text",name:"content",className:"todo-item__body__content",defaultValue:t.content})]}),Object(v.jsx)("div",{className:"todo-item__foot",children:Object(v.jsx)("button",{onClick:function(){return e=t.id,void _({variables:{id:e}});var e},children:Object(v.jsx)(E.c,{})})})]},t.id)}))})]})},L=(n(99),function(){return Object(v.jsx)(l.a,{domain:"dev-fuodkz7j.us.auth0.com",clientId:"fTOVIHQ0WCxDdJ33Z6XFZbrMpHhmeIlp",redirectUri:window.location.origin,children:Object(v.jsx)(N,{children:Object(v.jsx)(F,{})})})}),M=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,102)).then((function(e){var n=e.getCLS,c=e.getFID,o=e.getFCP,i=e.getLCP,a=e.getTTFB;n(t),c(t),o(t),i(t),a(t)}))};u.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(L,{})}),document.getElementById("root")),M()},99:function(t,e,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.d7d26dfe.chunk.js.map